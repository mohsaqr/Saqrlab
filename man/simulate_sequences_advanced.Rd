% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_sequences_advanced.R
\name{simulate_sequences_advanced}
\alias{simulate_sequences_advanced}
\title{Simulate Markov Chain Sequences (Advanced)}
\usage{
simulate_sequences_advanced(
  transition_matrix,
  initial_probabilities,
  max_seq_length,
  num_rows,
  stable_transitions = NULL,
  stability_prob = 0.95,
  unstable_mode = "unlikely_jump",
  unstable_random_transition_prob = 0.4,
  unstable_perturb_noise = 0.5,
  unlikely_prob_threshold = 0.1,
  min_na = 0,
  max_na = 0,
  include_na = TRUE
)
}
\arguments{
\item{transition_matrix}{Square numeric matrix of transition probabilities.
Rows must sum to 1. Row names define state names.}

\item{initial_probabilities}{Named numeric vector of initial state
probabilities. Must sum to 1.}

\item{max_seq_length}{Integer. Maximum length of each sequence.}

\item{num_rows}{Integer. Number of sequences (rows) to generate.}

\item{stable_transitions}{List of character vectors. Each vector contains
two state names defining a stable transition pair (from, to).
Default: NULL (no stable transitions).}

\item{stability_prob}{Numeric in (0 to 1). Probability of following a stable
transition when in a stable state. Default: 0.95.}

\item{unstable_mode}{Character. Mode for unstable transitions. One of:
\itemize{
\item "random_jump": Uniform random jump to any state.
\item "perturb_prob": Perturb transition probabilities with noise.
\item "unlikely_jump": Jump to states with low probability.
}
Default: "unlikely_jump".}

\item{unstable_random_transition_prob}{Numeric in (0 to 1). Probability of
taking an unstable action. Default: 0.4.}

\item{unstable_perturb_noise}{Numeric in (0 to 1). Noise factor for probability
perturbation mode. Default: 0.5.}

\item{unlikely_prob_threshold}{Numeric in (0 to 1). Threshold below which
transitions are considered "unlikely". Default: 0.1.}

\item{min_na}{Integer. Minimum number of NA values per sequence. Default: 0.}

\item{max_na}{Integer. Maximum number of NA values per sequence. Default: 0.}

\item{include_na}{Logical. Whether to include NAs in sequences. Default: TRUE.}
}
\value{
A data frame with \code{num_rows} rows and \code{max_seq_length} columns.
Each row is a sequence of state names, potentially with trailing NAs.
}
\description{
Generate sequences of states from a Markov chain with advanced stability
and instability modes. Supports stable transitions, probability perturbation,
and unlikely jump modes.
}
\details{
The function extends basic Markov chain simulation with:

\strong{Stable Transitions}: If the current state has a defined stable transition
and a random draw is below \code{stability_prob}, the sequence follows the stable
transition directly.

\strong{Unstable Modes} (when not following stable transitions):
\itemize{
\item "random_jump": With probability \code{unstable_random_transition_prob},
jump uniformly to any state.
\item "perturb_prob": Multiply transition probabilities by random noise
in range \verb{[1-noise, 1+noise]}, then renormalize.
\item "unlikely_jump": With probability \code{unstable_random_transition_prob},
jump to a state with transition probability below threshold.
}

NAs are added at the end of sequences, preserving at least 2 non-NA values.
}
\examples{
\dontrun{
# Create a 4-state transition matrix
trans_mat <- matrix(c(
  0.6, 0.2, 0.1, 0.1,
  0.1, 0.7, 0.1, 0.1,
  0.1, 0.1, 0.6, 0.2,
  0.2, 0.1, 0.1, 0.6
), nrow = 4, byrow = TRUE)
rownames(trans_mat) <- colnames(trans_mat) <- c("A", "B", "C", "D")

init_probs <- c(A = 0.25, B = 0.25, C = 0.25, D = 0.25)

# Define stable transitions: A->B and C->D are "stable"
stable <- list(c("A", "B"), c("C", "D"))

# Generate sequences with unlikely_jump mode
sequences <- simulate_sequences_advanced(
  transition_matrix = trans_mat,
  initial_probabilities = init_probs,
  max_seq_length = 30,
  num_rows = 100,
  stable_transitions = stable,
  stability_prob = 0.95,
  unstable_mode = "unlikely_jump",
  unstable_random_transition_prob = 0.3,
  min_na = 0,
  max_na = 5
)
}

}
