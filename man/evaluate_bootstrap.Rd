% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/evaluate_bootstrap.R
\name{evaluate_bootstrap}
\alias{evaluate_bootstrap}
\title{Evaluate Bootstrap Performance for a Single Simulation Run}
\usage{
evaluate_bootstrap(
  transition_matrix,
  initial_probabilities,
  stable_transitions,
  max_seq_length,
  num_rows,
  stability_prob,
  unstable_mode,
  unstable_random_transition_prob,
  unstable_perturb_noise,
  unlikely_prob_threshold,
  min_na,
  max_na,
  include_na,
  consistency_range,
  level
)
}
\arguments{
\item{transition_matrix}{Square numeric matrix of transition probabilities.
Rows must sum to 1. Row names define state names.}

\item{initial_probabilities}{Named numeric vector of initial state
probabilities. Must sum to 1.}

\item{stable_transitions}{List of character vectors. Each vector contains
two state names defining a stable (ground truth) transition pair.}

\item{max_seq_length}{Integer. Maximum length of each sequence.}

\item{num_rows}{Integer. Number of sequences to generate.}

\item{stability_prob}{Numeric in (0 to 1). Probability of following stable transitions.}

\item{unstable_mode}{Character. Mode for unstable transitions:
"random_jump", "perturb_prob", or "unlikely_jump".}

\item{unstable_random_transition_prob}{Numeric in (0 to 1). Probability of
unstable action.}

\item{unstable_perturb_noise}{Numeric in (0 to 1). Noise factor for perturbation mode.}

\item{unlikely_prob_threshold}{Numeric in (0 to 1). Threshold for unlikely transitions.}

\item{min_na}{Integer. Minimum NAs per sequence.}

\item{max_na}{Integer. Maximum NAs per sequence.}

\item{include_na}{Logical. Whether to include NAs.}

\item{consistency_range}{Numeric vector of length 2. Range for bootstrap
consistency analysis (e.g., c(0.75, 1.25)).}

\item{level}{Numeric in (0,1). Significance level for p-value threshold
(e.g., 0.05).}
}
\value{
A list containing:
\describe{
\item{per_edge}{Data frame with per-edge results including ground truth,
bootstrap significance, TP/TN/FP/FN, p-values, and metrics.}
\item{bootstrap_summary_raw}{Raw bootstrap summary from tna::bootstrap.}
\item{TP_matrix}{Matrix of true positives by edge.}
\item{TN_matrix}{Matrix of true negatives by edge.}
\item{FP_matrix}{Matrix of false positives by edge.}
\item{FN_matrix}{Matrix of false negatives by edge.}
}
Returns NULL if bootstrap fails.
}
\description{
Performs a single bootstrap evaluation run: generates sequences, fits a TNA
model, runs bootstrap analysis, and computes classification metrics for edge
detection compared to ground truth stable transitions.
}
\details{
The function:
\enumerate{
\item Generates sequences using \code{simulate_sequences_advanced()}.
\item Fits a TNA model and runs bootstrap analysis.
\item Creates a ground truth matrix from stable_transitions.
\item Compares bootstrap-significant edges to ground truth.
\item Computes TP, TN, FP, FN and derived metrics per edge.
}

An edge is considered "significant" if its p-value < level.
}
\examples{
\dontrun{
# Create transition matrix
trans_mat <- matrix(c(
  0.6, 0.3, 0.1,
  0.2, 0.6, 0.2,
  0.1, 0.2, 0.7
), nrow = 3, byrow = TRUE)
rownames(trans_mat) <- colnames(trans_mat) <- c("A", "B", "C")
init_probs <- c(A = 0.33, B = 0.34, C = 0.33)

# Define ground truth stable edges
stable <- list(c("A", "B"), c("B", "C"))

# Run single bootstrap evaluation
result <- evaluate_bootstrap(
  transition_matrix = trans_mat,
  initial_probabilities = init_probs,
  stable_transitions = stable,
  max_seq_length = 30,
  num_rows = 100,
  stability_prob = 0.95,
  unstable_mode = "random_jump",
  unstable_random_transition_prob = 0.5,
  unstable_perturb_noise = 0.5,
  unlikely_prob_threshold = 0.1,
  min_na = 0,
  max_na = 5,
  include_na = TRUE,
  consistency_range = c(0.75, 1.25),
  level = 0.05
)
}

}
