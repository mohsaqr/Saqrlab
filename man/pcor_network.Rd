% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_pcor_network.R
\name{pcor_network}
\alias{pcor_network}
\title{Partial Correlation Network via EBICglasso}
\usage{
pcor_network(
  data,
  id_col = NULL,
  n = NULL,
  gamma = 0.5,
  nlambda = 100L,
  lambda.min.ratio = 0.01,
  penalize.diagonal = FALSE,
  threshold = 1e-04,
  cor_method = c("pearson", "spearman", "kendall"),
  input_type = c("auto", "cor", "cov")
)
}
\arguments{
\item{data}{A data frame of per-sequence action frequencies (e.g., output of
\code{\link{convert_sequence_format}} with \code{format = "frequency"}),
or a square symmetric correlation/covariance matrix.}

\item{id_col}{Character vector. Name(s) of ID column(s) to exclude when
\code{data} is a data frame. If NULL, columns named \code{"rid"} and
non-numeric columns are automatically excluded. Default: NULL.}

\item{n}{Integer. Sample size. Required when \code{data} is a matrix.
Ignored when \code{data} is a data frame (n is taken from \code{nrow()}).
Default: NULL.}

\item{gamma}{Numeric. EBIC tuning parameter controlling sparsity preference.
Higher values (e.g., 0.5) favour sparser networks; 0 reduces to BIC.
Default: 0.5.}

\item{nlambda}{Integer. Number of lambda values in the regularisation path.
Default: 100.}

\item{lambda.min.ratio}{Numeric. Ratio of the smallest to the largest lambda
value. Default: 0.01.}

\item{penalize.diagonal}{Logical. Whether to penalise the diagonal of the
precision matrix. Default: FALSE.}

\item{threshold}{Numeric. Absolute values in the partial correlation matrix
below this are set to zero. Default: 1e-4.}

\item{cor_method}{Character. Correlation method when computing from a data
frame: \code{"pearson"}, \code{"spearman"}, or \code{"kendall"}.
Default: \code{"pearson"}.}

\item{input_type}{Character. How to interpret a matrix input:
\code{"auto"} (detect from diagonal), \code{"cor"}, or \code{"cov"}.
Default: \code{"auto"}.}
}
\value{
An object of class \code{"pcor_network"}, a list containing:
\describe{
\item{pcor_matrix}{Sparse partial correlation matrix (zero-diagonal).}
\item{precision_matrix}{Estimated precision (inverse covariance) matrix.}
\item{cor_matrix}{Correlation matrix used as input.}
\item{edges}{Data frame of non-zero edges (from, to, weight).}
\item{lambda_selected}{The lambda value of the selected model.}
\item{ebic_selected}{The EBIC value of the selected model.}
\item{lambda_path}{Numeric vector of all lambda values evaluated.}
\item{ebic_path}{Numeric vector of EBIC values for each lambda.}
\item{n}{Sample size.}
\item{p}{Number of variables.}
\item{gamma}{EBIC gamma used.}
\item{n_edges}{Number of non-zero edges.}
}
}
\description{
Estimates a sparse partial correlation network from frequency data or a
correlation/covariance matrix using the graphical lasso with EBIC model
selection. The graphical lasso is fit across a path of penalty values
(lambda), and the model with the lowest Extended Bayesian Information
Criterion (EBIC) is selected.
}
\details{
When \code{data} is a data frame, the function automatically excludes
non-numeric columns, ID columns (\code{id_col} and \code{"rid"}), columns
with non-syntactic names (e.g., \code{"\%"}), zero-variance columns, and
columns that are entirely \code{NA}. Rows with any \code{NA} in the
remaining columns are dropped before computing correlations.

The estimation proceeds as follows:
\enumerate{
\item Compute the correlation matrix from frequency data (or use supplied
matrix directly).
\item Generate a logarithmically spaced path of lambda values.
\item For each lambda, fit the graphical lasso via \code{glasso::glasso()}
using warm starts.
\item Compute the EBIC for each fit and select the model with the lowest
EBIC.
\item Convert the selected precision matrix to partial correlations.
}
}
\examples{
\dontrun{
library(tna)

# From wide sequence data
freq <- convert_sequence_format(group_regulation, format = "frequency")
net <- pcor_network(freq)
print(net)

# From a correlation matrix
cor_mat <- cor(freq[, -c(1, 2)])
net2 <- pcor_network(cor_mat, n = nrow(freq))
}

}
\seealso{
\code{\link{convert_sequence_format}} for producing frequency data.
}
