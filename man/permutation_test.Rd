% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/permutation_test.R
\name{permutation_test}
\alias{permutation_test}
\title{Permutation Test for Network Comparison}
\usage{
permutation_test(
  x,
  y,
  iter = 1000L,
  alpha = 0.05,
  paired = FALSE,
  adjust = "none",
  seed = NULL
)
}
\arguments{
\item{x}{A \code{netobject} (from \code{\link{build_network}}).}

\item{y}{A \code{netobject} (from \code{\link{build_network}}).
Must use the same method and have the same nodes as \code{x}.}

\item{iter}{Integer. Number of permutation iterations (default: 1000).}

\item{alpha}{Numeric. Significance level (default: 0.05).}

\item{paired}{Logical. If \code{TRUE}, permute within pairs (requires
equal number of observations in \code{x} and \code{y}). Default: FALSE.}

\item{adjust}{Character. p-value adjustment method passed to
\code{\link[stats]{p.adjust}} (default: \code{"none"}). Common choices:
\code{"holm"}, \code{"BH"}, \code{"bonferroni"}.}

\item{seed}{Integer or NULL. RNG seed for reproducibility.}
}
\value{
An object of class \code{"saqr_permutation"} containing:
\describe{
\item{x}{The first \code{netobject}.}
\item{y}{The second \code{netobject}.}
\item{diff}{Observed difference matrix (\code{x - y}).}
\item{diff_sig}{Observed difference where \code{p < alpha}, else 0.}
\item{p_values}{P-value matrix (adjusted if \code{adjust != "none"}).}
\item{effect_size}{Effect size matrix (observed diff / SD of permutation diffs).}
\item{summary}{Long-format data frame of edge-level results.}
\item{method}{The network estimation method.}
\item{iter}{Number of permutation iterations.}
\item{alpha}{Significance level used.}
\item{paired}{Whether paired permutation was used.}
\item{adjust}{p-value adjustment method used.}
}
}
\description{
Compares two networks estimated by \code{\link{build_network}} using a
permutation test. Works with all built-in methods (transition and
association) as well as custom registered estimators. The test shuffles
which observations belong to which group, re-estimates networks, and tests
whether observed edge-wise differences exceed chance.

For transition methods (\code{"relative"}, \code{"frequency"},
\code{"co_occurrence"}), uses a fast pre-computation strategy: per-sequence
count matrices are computed once, and each permutation iteration only
shuffles group labels and computes group-wise \code{colSums}.

For association methods (\code{"cor"}, \code{"pcor"}, \code{"glasso"},
and custom estimators), the full estimator is called on each permuted
group split.
}
\examples{
\dontrun{
library(tna)
d1 <- group_regulation[1:1000, ]
d2 <- group_regulation[1001:2000, ]
net1 <- build_network(d1, method = "relative")
net2 <- build_network(d2, method = "relative")
perm <- permutation_test(net1, net2, iter = 500, seed = 42)
print(perm)
summary(perm)
}

}
\seealso{
\code{\link{build_network}}, \code{\link{bootstrap_network}},
\code{\link{print.saqr_permutation}},
\code{\link{summary.saqr_permutation}},
\code{\link{plot.saqr_permutation}}
}
